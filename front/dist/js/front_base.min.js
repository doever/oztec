function FrontBase(){this.authBox=$(".auth-box"),this.userMoreBox=$(".user-more-box")}function getStyle(t,n){return t.currentStyle?t.currentStyle[n]:getComputedStyle(t,!1)[n]}function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.signInBtn=$(".signin-btn"),t.signUpBtn=$(".signup-btn"),t.closeBtn=$(".close-btn"),t.authBox=$(".auth-inner-group"),t.smsCaptchaBtn=$(".sms-captcha-btn")}FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=this;t.authBox.hover(function(){t.userMoreBox.show()},function(){t.userMoreBox.hide()})},$(function(){(new FrontBase).run()}),Auth.prototype.run=function(){this.listenCloseEvent(),this.listenAuthBoxClickEvent(),this.listenSwitchEvent(),this.listenSignIn(),this.listenImgCaptchaEvent(),this.listenSmsCaptchaEvent()},Auth.prototype.listenAuthBoxClickEvent=function(){var t=this;t.signInBtn.click(function(){t.authBox.css({left:0}),t.showEvent()}),t.signUpBtn.click(function(){t.authBox.css({left:-400}),t.showEvent()})},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hiddenEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenCloseEvent=function(){var t=this;t.closeBtn.click(function(){t.hiddenEvent()})},Auth.prototype.listenSwitchEvent=function(){var t=this;$(".switch").click(function(){0<=parseInt(getStyle(t.authBox[0],"left"))?t.authBox.animate({left:"-400px"}):t.authBox.animate({left:0})})},Auth.prototype.listenSignIn=function(){var s=this;$(".signin-group").find(".submit-btn").click(function(){var t=$(".signin-group").find('input[name="telephone"]').val(),n=$(".signin-group").find('input[name="password"]').val(),e=$(".signin-group").find('input[name="remember"]').prop("checked");e=e?1:0,csrfajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e},success:function(t){if(200===t.code)s.hiddenEvent(),window.location.reload();else{var n=t.message;if("string"==typeof n||n.constructor==String)window.messageBox.show(n);else for(var e in n){var o=n[e][0];window.messageBox.show(o)}}},fail:function(t){console.log(t)}})})},Auth.prototype.listenImgCaptchaEvent=function(){$(".img-captcha").click(function(){$(this).attr({src:"/account/img_captcha?random"+Math.random()})})},Auth.prototype.listenSmsCaptchaEvent=function(){var o=this,n=$(".signup-group input[name='telephone']");o.smsCaptchaBtn.click(function(){var t=n.val();/^1\d{10}$/.test(t)?csrfajax.get({url:"/account/sms_code/",data:{telephone:t},success:function(t){window.messageBox.showSuccess("短信发送成功"),o.smsCaptchaBtn.addClass("disabled"),o.smsCaptchaBtn.text("60s");var n=59,e=setInterval(function(){o.smsCaptchaBtn.unbind("click"),o.smsCaptchaBtn.text(n+"s"),(n-=1)<=0&&(o.smsCaptchaBtn.removeClass("disabled"),o.smsCaptchaBtn.text("发送短信"),clearInterval(e),o.listenSmsCaptchaEvent())},1e3)},fail:function(t){console.log(t)}}):t?window.messageBox.showError("请输入合法的手机号啊"):(console.log(t),window.messageBox.showInfo("请输入手机号"))})},$(function(){(new Auth).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwidGhpcyIsImF1dGhCb3giLCIkIiwidXNlck1vcmVCb3giLCJnZXRTdHlsZSIsIm9iaiIsIm5hbWUiLCJjdXJyZW50U3R5bGUiLCJnZXRDb21wdXRlZFN0eWxlIiwiQXV0aCIsInNlbGYiLCJtYXNrV3JhcHBlciIsInNpZ25JbkJ0biIsInNpZ25VcEJ0biIsImNsb3NlQnRuIiwic21zQ2FwdGNoYUJ0biIsInByb3RvdHlwZSIsInJ1biIsImxpc3RlbkF1dGhCb3hIb3ZlciIsImhvdmVyIiwic2hvdyIsImhpZGUiLCJsaXN0ZW5DbG9zZUV2ZW50IiwibGlzdGVuQXV0aEJveENsaWNrRXZlbnQiLCJsaXN0ZW5Td2l0Y2hFdmVudCIsImxpc3RlblNpZ25JbiIsImxpc3RlbkltZ0NhcHRjaGFFdmVudCIsImxpc3RlblNtc0NhcHRjaGFFdmVudCIsImNsaWNrIiwiY3NzIiwibGVmdCIsInNob3dFdmVudCIsImhpZGRlbkV2ZW50IiwicGFyc2VJbnQiLCJhbmltYXRlIiwiZmluZCIsInRlbGVwaG9uZSIsInZhbCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJwcm9wIiwiY3NyZmFqYXgiLCJwb3N0IiwidXJsIiwiZGF0YSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsIm1lc3NhZ2VPYmoiLCJjb25zdHJ1Y3RvciIsIlN0cmluZyIsIm1lc3NhZ2VCb3giLCJrZXkiLCJtZXNzYWdlIiwiZmFpbCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsImF0dHIiLCJzcmMiLCJNYXRoIiwicmFuZG9tIiwidGVsZXBob25lSW5wdXQiLCJ0ZXN0IiwiZ2V0Iiwic2hvd1N1Y2Nlc3MiLCJhZGRDbGFzcyIsInRleHQiLCJjb3VudCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ1bmJpbmQiLCJyZW1vdmVDbGFzcyIsImNsZWFySW50ZXJ2YWwiLCJzaG93RXJyb3IiLCJzaG93SW5m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VVUsc0JBQXdCLFdBRWxCeEIsRUFBRSxnQkFDUjBCLE1BQU0sV0FDYjFCLEVBQUVGLE1BQU00RCxLQUFLLENBQUNDLElBQU0sOEJBQThCQyxLQUFLQyxjQUkvRHRELEtBQUtPLFVBQVVXLHNCQUF3QixXQUNuQyxJQUFJakIsRUFBT1YsS0FFUGdFLEVBQWlCOUQsRUFBRSx5Q0FHdkJRLEVBQUtLLGNBQWNhLE1BQU0sV0FDckIsSUFBSVEsRUFBWTRCLEVBQWUzQixNQUM1QixZQUFZNEIsS0FBSzdCLEdBQ2hCSyxTQUFTeUIsSUFBSSxDQUNUdkIsSUFBTSxxQkFDTkMsS0FBTyxDQUNIUixVQUFZQSxHQUVoQlMsUUFBVSxTQUFVQyxHQUNoQkMsT0FBT00sV0FBV2MsWUFBWSxVQUM5QnpELEVBQUtLLGNBQWNxRCxTQUFTLFlBQzVCMUQsRUFBS0ssY0FBY3NELEtBQUssT0FDeEIsSUFBSUMsRUFBUSxHQUNSQyxFQUFRQyxZQUFZLFdBQ3BCOUQsRUFBS0ssY0FBYzBELE9BQU8sU0FDMUIvRCxFQUFLSyxjQUFjc0QsS0FBS0MsRUFBTSxNQUM5QkEsR0FBTyxJQUNHLElBQ041RCxFQUFLSyxjQUFjMkQsWUFBWSxZQUMvQmhFLEVBQUtLLGNBQWNzRCxLQUFLLFFBQ3hCTSxjQUFjSixHQUNkN0QsRUFBS2lCLDBCQUVYLE1BRU42QixLQUFPLFNBQVVDLEdBQ2JDLFFBQVFDLElBQUlGLE1BR2RyQixFQUlOVyxPQUFPTSxXQUFXdUIsVUFBVSxlQUg1QmxCLFFBQVFDLElBQUl2QixHQUNaVyxPQUFPTSxXQUFXd0IsU0FBUyxjQU92QzNFLEVBQUUsWUFDYSxJQUFJTyxNQUNWUSIsImZpbGUiOiJmcm9udF9iYXNlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8v5aSE55CG5a+86Iiq5p2h5LqL5Lu2XHJcbmZ1bmN0aW9uIEZyb250QmFzZSgpIHtcclxuICAgICB0aGlzLmF1dGhCb3ggPSAkKCcuYXV0aC1ib3gnKTtcclxuICAgICB0aGlzLnVzZXJNb3JlQm94ID0gJCgnLnVzZXItbW9yZS1ib3gnKTtcclxufVxyXG5cclxuRnJvbnRCYXNlLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxpc3RlbkF1dGhCb3hIb3ZlcigpO1xyXG59O1xyXG5cclxuRnJvbnRCYXNlLnByb3RvdHlwZS5saXN0ZW5BdXRoQm94SG92ZXIgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5hdXRoQm94LmhvdmVyKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLnVzZXJNb3JlQm94LnNob3coKTtcclxuICAgIH0sZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYudXNlck1vcmVCb3guaGlkZSgpO1xyXG4gICAgfSlcclxufTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGZyb250YmFzZSA9IG5ldyBGcm9udEJhc2UoKTtcclxuICAgIGZyb250YmFzZS5ydW4oKTtcclxufSk7XHJcblxyXG5cclxuXHJcbi8v5aSE55CG55m75b2V55u45YWz5Yqf6IO9XHJcbmZ1bmN0aW9uIGdldFN0eWxlKG9iaixuYW1lKXtcclxuICAgIGlmKG9iai5jdXJyZW50U3R5bGUpe1xyXG4gICAgICAgIHJldHVybiBvYmouY3VycmVudFN0eWxlW25hbWVdO1xyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgICByZXR1cm4gZ2V0Q29tcHV0ZWRTdHlsZShvYmosZmFsc2UpW25hbWVdO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiAgQXV0aCgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubWFza1dyYXBwZXIgPSAkKFwiLm1hc2std3JhcHBlclwiKTtcclxuICAgIHNlbGYuc2lnbkluQnRuID0gJChcIi5zaWduaW4tYnRuXCIpO1xyXG4gICAgc2VsZi5zaWduVXBCdG4gPSAkKFwiLnNpZ251cC1idG5cIik7XHJcbiAgICBzZWxmLmNsb3NlQnRuID0gJChcIi5jbG9zZS1idG5cIik7XHJcbiAgICBzZWxmLmF1dGhCb3ggPSAkKFwiLmF1dGgtaW5uZXItZ3JvdXBcIik7XHJcbiAgICBzZWxmLnNtc0NhcHRjaGFCdG4gPSAkKFwiLnNtcy1jYXB0Y2hhLWJ0blwiKTtcclxufVxyXG5BdXRoLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxpc3RlbkNsb3NlRXZlbnQoKTtcclxuICAgIHRoaXMubGlzdGVuQXV0aEJveENsaWNrRXZlbnQoKTtcclxuICAgIHRoaXMubGlzdGVuU3dpdGNoRXZlbnQoKTtcclxuICAgIHRoaXMubGlzdGVuU2lnbkluKCk7XHJcbiAgICB0aGlzLmxpc3RlbkltZ0NhcHRjaGFFdmVudCgpO1xyXG4gICAgdGhpcy5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlbkF1dGhCb3hDbGlja0V2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuc2lnbkluQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLmF1dGhCb3guY3NzKHtcImxlZnRcIjowfSk7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgIH0pO1xyXG4gICAgc2VsZi5zaWduVXBCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuYXV0aEJveC5jc3Moe1wibGVmdFwiOi00MDB9KTtcclxuICAgICAgICBzZWxmLnNob3dFdmVudCgpO1xyXG4gICAgfSlcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLnNob3dFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gIHNlbGYubWFza1dyYXBwZXIuc2hvdygpO1xyXG59O1xyXG5BdXRoLnByb3RvdHlwZS5oaWRkZW5FdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLmhpZGUoKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlbkNsb3NlRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5jbG9zZUJ0bi5jbGljayhcclxuICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuRXZlbnQoKTtcclxuICAgICAgICB9XHJcbiAgICApO1xyXG59O1xyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5Td2l0Y2hFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc3dpdGNoQnRuID0gJChcIi5zd2l0Y2hcIik7XHJcbiAgICBzd2l0Y2hCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGN1cnJlbnRfd2lkdGggPSBwYXJzZUludChnZXRTdHlsZShzZWxmLmF1dGhCb3hbMF0sXCJsZWZ0XCIpKTtcclxuICAgIGlmKGN1cnJlbnRfd2lkdGg+PTApe1xyXG4gICAgICAgIHNlbGYuYXV0aEJveC5hbmltYXRlKHtcImxlZnRcIjpcIi00MDBweFwifSk7XHJcbiAgICB9XHJcbiAgICBlbHNle1xyXG4gICAgICAgIHNlbGYuYXV0aEJveC5hbmltYXRlKHtcImxlZnRcIjowfSk7XHJcbiAgICB9XHJcbn0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2lnbkluID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBsb2dpbkJ0biA9ICAkKFwiLnNpZ25pbi1ncm91cFwiKS5maW5kKFwiLnN1Ym1pdC1idG5cIik7XHJcbiAgICBsb2dpbkJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9ICQoXCIuc2lnbmluLWdyb3VwXCIpLmZpbmQoJ2lucHV0W25hbWU9XCJ0ZWxlcGhvbmVcIl0nKS52YWwoKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQgPSAkKFwiLnNpZ25pbi1ncm91cFwiKS5maW5kKCdpbnB1dFtuYW1lPVwicGFzc3dvcmRcIl0nKS52YWwoKTtcclxuICAgICAgICB2YXIgcmVtZW1iZXIgPSAkKFwiLnNpZ25pbi1ncm91cFwiKS5maW5kKCdpbnB1dFtuYW1lPVwicmVtZW1iZXJcIl0nKS5wcm9wKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICByZW1lbWJlciA9IHJlbWVtYmVyPzE6MDtcclxuICAgICAgICBjc3JmYWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6Jy9hY2NvdW50L2xvZ2luLycsXHJcbiAgICAgICAgICAgICdkYXRhJzp7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzp0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOnBhc3N3b3JkLFxyXG4gICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzpyZW1lbWJlclxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6ZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ109PT0yMDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGlkZGVuRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZU9iaiA9IHJlc3VsdFsnbWVzc2FnZSddO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBtZXNzYWdlT2JqID09J3N0cmluZycgfHwgbWVzc2FnZU9iai5jb25zdHJ1Y3RvciA9PSBTdHJpbmcpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2VPYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB7J3Bhc3N3b3JkJzpbJ3h4eCcsJ3NzcyddfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGtleSBpbiBtZXNzYWdlT2JqKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlcyA9IG1lc3NhZ2VPYmpba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWwnOmZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5JbWdDYXB0Y2hhRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIGNhcHRjaGFPYmogPSAkKCcuaW1nLWNhcHRjaGEnKTtcclxuICAgIGNhcHRjaGFPYmouY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQodGhpcykuYXR0cih7XCJzcmNcIjpcIi9hY2NvdW50L2ltZ19jYXB0Y2hhP3JhbmRvbVwiK01hdGgucmFuZG9tKCl9KVxyXG4gICAgfSlcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAvLyBjb25zb2xlLmxvZygkKFwiLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKSk7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSAkKFwiLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKCQoXCIuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpWzBdKTtcclxuICAgIC8vIHZhciB0ZWxlcGhvbmUgPSAkKFwiLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKVswXS52YWwoKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIGlmKC9eMVxcZHsxMH0kLy50ZXN0KHRlbGVwaG9uZSkpe1xyXG4gICAgICAgICAgICBjc3JmYWpheC5nZXQoe1xyXG4gICAgICAgICAgICAgICAgJ3VybCc6Jy9hY2NvdW50L3Ntc19jb2RlLycsXHJcbiAgICAgICAgICAgICAgICAnZGF0YSc6e1xyXG4gICAgICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOnRlbGVwaG9uZVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICdzdWNjZXNzJzpmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+efreS/oeWPkemAgeaIkOWKnycpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYUJ0bi5hZGRDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNtc0NhcHRjaGFCdG4udGV4dCgnNjBzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gNTk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNtc0NhcHRjaGFCdG4udW5iaW5kKCdjbGljaycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNtc0NhcHRjaGFCdG4udGV4dChjb3VudCsncycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudC09MTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoY291bnQ8PTApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhQnRuLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhQnRuLnRleHQoXCLlj5HpgIHnn63kv6FcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGVuU21zQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LDEwMDApXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgJ2ZhaWwnOmZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9ZWxzZSBpZighdGVsZXBob25lKXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2codGVsZXBob25lKTtcclxuICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0luZm8oXCLor7fovpPlhaXmiYvmnLrlj7dcIik7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihcIuivt+i+k+WFpeWQiOazleeahOaJi+acuuWPt+WVilwiKTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59O1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aCA9IG5ldyBBdXRoKCk7XHJcbiAgICBhdXRoLnJ1bigpO1xyXG59KTsiXX0=
